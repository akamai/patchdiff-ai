{'file': 'activationmanager.dll', 'patch_store_uid': 'cc32b694-3173-4daa-afe6-6d44c45f18ba', 'kb': 'KB5066835', 'cve': 'CVE-2025-62209', 'confidence': 0.19, 'date': 1763409646.3919623, 'change_count': 5}
--------------------------------------------------------------------
Unknown-CVE Report
--------------------------------------------------------------------

Component
--------------------------------------------------------------------
Windows License Manager / activationmanager.dll  
Function: wil::details::FeatureImpl<...>::ReportUsage()  
Module version prior to February 2025 security patch

Vulnerability Class
--------------------------------------------------------------------
Information Disclosure – CWE-532: Insertion of Sensitive Information
into Log File

Detailed Root Cause Analysis
--------------------------------------------------------------------
The helper wil::details::FeatureImpl<>::ReportUsage() is responsible
for forwarding feature-usage telemetry to the Windows Instrumentation
library (WIL).  A six-parameter call is performed to
wil::details::ReportUsageToService().  Parameter #6 represents the
"ReportingKind" enumeration which determines where usage data is
recorded (service-only, local log file, or both).

Before the patch the second user-supplied argument (a2) was defined as
an unsigned 8-bit boolean and copied unvalidated into parameter #6.  If
callers passed 0 (or any unexpected value) the routine selected the
"local log" path, causing the full usage payload – including licensing
state bits extracted from GetCachedFeatureEnabledState() – to be
written to an on-disk log file that is readable by any authenticated
local user.  Because the data contains feature enablement flags and
other internal licensing metadata, the log constitutes sensitive
information.

The vulnerable logic therefore allowed any in-process caller that could
invoke ReportUsage() to force insertion of licensing details into a
persistent, world-readable log, violating confidentiality.

Structures / fields involved:  
  * Parameter #6 (wil::ReportingKind) of ReportUsageToService()  
  * Licensing state bits: (value >> 10)&1 and (value >> 11)&1  
  * Temporary flag container v9 / v10 controlling WIL header flags

Vulnerability Code Snippets
--------------------------------------------------------------------
```c
// before
int v6 = a2;                     // caller-controlled
...
return wil::details::ReportUsageToService(
        a1 + 2,
        54237977i64,
        ((unsigned int)v4 >> 10) & 1,
        ((unsigned int)v4 >> 11) & 1,
        &v9,
        v6,                      // unknowingly chooses log target
        0);

// after
v9 = 3;                          // strict flags
...
return wil::details::ReportUsageToService(
        a1 + 2,
        54237977i64,
        (v4 >> 10) & 1,
        (v4 >> 11) & 1,
        &v8,
        1,                       // service-only, no local log
        0);
```

Trigger Flow (Top-Down)
--------------------------------------------------------------------
User-mode code -> License Manager API -> ReportUsage(bool kind)  
        -> copies caller-controlled "kind" into ReportingKind  
        -> ReportUsageToService() with value 0  
        -> WIL outputs sensitive licensing payload to local log file

Attack Vector
--------------------------------------------------------------------
A locally authenticated attacker that can load activationmanager.dll
and execute the public Feature ReportUsage() path (e.g., via any
application scriptable interface that wraps it) supplies 0 as the
second argument, forcing sensitive data into an easily accessible log
under %ProgramData%\Microsoft\Windows\WIL\logs.

Patch Description
--------------------------------------------------------------------
1. Formalised parameter types: second argument changed from unsigned
   byte to 64-bit integer matching wil::ReportingKind enum.
2. The function now hard-codes ReportingKind to 1 (service-only),
   preventing callers from selecting local logging.
3. Header flag v9 initialised to 3 instead of uninitialised 0/2 to
   comply with updated WIL contract.

Security Impact
--------------------------------------------------------------------
Prior to the patch any local user could coerce Windows License Manager
into persisting internal licensing state, potentially revealing feature
activation status and diagnostic identifiers that aid further
privilege-escalation or license circumvention efforts.

Fix Effectiveness
--------------------------------------------------------------------
The patch removes caller influence over the ReportingKind field; usage
is now always sent directly to the telemetry service with no local log
side-effects.  Because the constant is set inside the function and the
parameter type no longer matches the external prototype, the original
misuse path is fully closed.  No obvious residual path remains.

