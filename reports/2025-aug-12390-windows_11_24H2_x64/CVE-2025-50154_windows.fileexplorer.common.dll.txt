{'date': 1755086593.4820778, 'kb': 'KB5063878', 'cve': 'CVE-2025-50154', 'patch_store_uid': '0215dbee-200b-40c9-8d33-74c3d247af0b', 'file': 'windows.fileexplorer.common.dll', 'change_count': 6, 'confidence': 0.19}
--------------------------------------------------------------------
CVE-2025-50154 Report
--------------------------------------------------------------------

Component
--------------------------------------------------------------------
windows.fileexplorer.common.dll  (Windows File Explorer)
Hybrid-Compute capability detection logic –
SemanticSearchHardwareRequirementsSlim::IsHcfPresent()

Vulnerability Class
--------------------------------------------------------------------
Insecure configuration / insufficient input validation resulting in a
spoofing-driven information disclosure (CWE-200)

Detailed Root Cause Analysis
--------------------------------------------------------------------
Prior to the patch File Explorer decided whether the system supports
Hybrid Compute Framework (HCF) exclusively by looking at an
unprotected registry location:
  HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WorkloadManager\
      HCF\Status  (read with KEY_QUERY_VALUE | KEY_WOW64_64KEY)

The function SemanticSearchHardwareRequirementsSlim::IsHcfPresent()
executed the following sequence:
 1.  RegOpenKeyExW() against the above path.
 2.  wil::reg_view_details::try_get_value<UINT>() to fetch an unnamed
     DWORD.
 3.  Returned TRUE when the DWORD was non-zero; otherwise FALSE.

No authenticity checks, ACL validation, or value sanity checks were
performed.  If an attacker (local low-privilege user or a remote actor
via Remote Registry / GPO deployment) places or modifies that value, the
process will assume HCF is present although the machine may not
actually support the feature.  The presence flag propagates into
several higher-level decision paths – most notably the new
Copilot/Semantic-Search experience – causing:
 • Exposure of internal feature-gating state to the attacker (by
   observing UI/telemetry differences).
 • Ability to spoof hardware capabilities and trick the shell into
   enabling code paths that were never intended to run, potentially
   leading to further undefined behaviour or UI mis-representation.

No further permission checks are executed after the registry read, so
the spoof succeeds under the security context of the File Explorer
process (typically the interactive user).  Because HKLM can be
remotely writable in certain enterprise deployments, the attack can be
performed over the network, matching Microsoft’s classification as a
network-based spoofing issue.

Vulnerability Code Snippets
--------------------------------------------------------------------
```c
// before patch – SemanticSearchHardwareRequirementsSlim::IsHcfPresent()
RegOpenKeyExW(HKEY_LOCAL_MACHINE,
    L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WorkloadManager\\HCF\\Status",
    0, 0x20019u, &hKey);
...
wil::reg_view_details::try_get_value<unsigned int>(hKey, &value, ...);
return value != 0;
```
```c
// after patch – SemanticSearchHardwareRequirementsSlim::IsHybridComputeFrameworkPresent()
if (wil::details::FeatureImpl<...>::__private_IsEnabled(...))
    return udk::npu_detection::_anonymous_namespace_::
                 IsHybridComputeFrameworkPresent();
return 0;
```

Trigger Flow (Top-Down)
--------------------------------------------------------------------
1. Attacker writes non-zero DWORD to the registry key stated above.
2. Victim launches File Explorer (explorer.exe).
3. explorer.exe loads windows.fileexplorer.common.dll.
4. During capability probing it calls
   IsHcfPresent() -> reads forged value -> returns TRUE.
5. Explorer enables Hybrid Compute/semantic search UI paths, leaking
   internal feature-state and giving the appearance of unsupported
   hardware.

Attack Vector
--------------------------------------------------------------------
Any mechanism that allows the attacker to modify HKLM on the target
(e.g. Remote Registry, malicious MSI, mis-configured permissions,
registry reflection, or supply-chain delivered .reg payloads).  No code
execution inside Explorer is required – only the ability to write the
DWORD.

Patch Description
--------------------------------------------------------------------
• Entire registry-based detection logic was deleted.
• New implementation relies on
  udk::npu_detection::IsHybridComputeFrameworkPresent(), a trusted
  system API that enumerates hardware directly rather than user
  controlled configuration.
• Early exit is now executed when the related WIL feature flag is not
  enabled, reducing attack surface.

Security Impact
--------------------------------------------------------------------
Before the fix any low-privileged or remote actor able to modify the
registry key could
  1. Force File Explorer to mis-report hardware capabilities
     (spoofing).
  2. Infer internal feature flags by observing UI/telemetry changes,
     leaking information that should remain internal (CWE-200).

Although no code execution is gained, the spoofing could be chained
with other issues that assume genuine HCF support.

Fix Effectiveness
--------------------------------------------------------------------
The vulnerable code path has been entirely removed; decision making is
now delegated to a non-configurable OS routine.  Unless that API is
itself vulnerable (unknown), the specific registry-spoof vector is
closed.  No residual exposure via the original key remains, so the fix
is considered effective.
